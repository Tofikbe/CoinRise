<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JokeFi Wallet - Kingdom Blockchain</title>
<style>
body{
  margin:0;font-family:Arial,sans-serif;background:#f8f1e9;color:#333;display:flex;justify-content:center;align-items:center;min-height:100vh;overflow-x:hidden;
}
.wallet-container{
  background:#fffcf5;padding:2rem;border-radius:10px;box-shadow:0 4px 10px rgba(0,0,0,0.1);width:100%;max-width:650px;text-align:center;position:relative;
}
h1{font-size:2rem;margin-bottom:0.5rem;}
.subtitle{font-size:1rem;color:#666;margin-bottom:1.5rem;}
.scanner-btn{position:absolute;top:1rem;right:1rem;background:#d6c6a8;color:#333;border:none;border-radius:50%;padding:0.6rem;cursor:pointer;}
.balance{font-size:2.5rem;font-weight:bold;margin:1rem 0;color:#2c3e50;}
.buttons{display:flex;justify-content:center;gap:1rem;margin-bottom:1.5rem;}
button{padding:0.8rem 1.5rem;border:none;border-radius:5px;font-size:1rem;cursor:pointer;transition:0.3s;}
.cream-btn{background-color:#d6c6a8;color:#333;}
.cream-btn:hover{background-color:#c9b894;}
.divider{border-top:1px solid #ddd;margin:1.5rem 0;}
.tokens-grid{display:flex;flex-direction:column;gap:0.8rem;}
.token{background:#f9f9f9;padding:0.8rem;border-radius:5px;display:flex;justify-content:space-between;align-items:center;cursor:pointer;transition:0.2s;}
.token:hover{transform:scale(1.02);}
.token-price{font-weight:bold;color:#27ae60;}
.token-name{display:flex;align-items:center;gap:0.5rem;}
.popup,.token-popup,.scanner-popup{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);justify-content:center;align-items:center;z-index:1000;}
.popup-content,.token-popup-content,.scanner-popup-content{background:white;padding:2rem;border-radius:10px;text-align:center;max-width:400px;width:90%;}
.popup-content p,.scanner-popup-content p{word-break:break-all;margin-bottom:1rem;cursor:pointer;}
.close-btn{background-color:#95a5a6;color:white;padding:0.5rem 1rem;border:none;border-radius:5px;cursor:pointer;}
.close-btn:hover{background-color:#7f8c8d;}
input{margin:0.5rem 0;padding:0.6rem;width:90%;border-radius:5px;border:1px solid #ccc;}
canvas{margin-bottom:1rem;}
.tokenomics-circle{width:200px;height:200px;border-radius:50%;position:relative;margin:auto;}
.segment{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%;clip:rect(0px,200px,200px,100px);}
.segment-inner{position:absolute;width:100%;height:100%;border-radius:50%;clip:rect(0px,100px,200px,0px);}
</style>
</head>
<body>
<div class="wallet-container">
<button class="scanner-btn" onclick="openScanner()">üî≤</button>
<h1>JokeFi Wallet</h1>
<div class="subtitle">Kingdom Blockchain Testnet</div>
<div class="balance" id="balance">0 KDM</div>
<div class="buttons">
  <button class="cream-btn" onclick="deposit()">Deposit</button>
  <button class="cream-btn" onclick="receive()">Receive</button>
  <button class="cream-btn" onclick="openSendPopup()">Send</button>
</div>
<div class="divider"></div>
<div class="tokens-grid" id="tokens-grid"></div>
</div>

<!-- Receive Popup -->
<div class="popup" id="receive-popup">
<div class="popup-content">
<canvas id="qr-code"></canvas>
<p id="wallet-address" onclick="copyAddress()"></p>
<button class="close-btn" onclick="closePopup()">Close</button>
</div>
</div>

<!-- Send Popup -->
<div class="popup" id="send-popup">
<div class="popup-content">
<h3>Send KDM</h3>
<input type="text" id="send-address" placeholder="Recipient Address">
<input type="number" id="send-amount" placeholder="Amount (KDM)">
<button class="cream-btn" onclick="send()">Send</button>
<br><br>
<button class="close-btn" onclick="closeSendPopup()">Close</button>
</div>
</div>

<!-- Token Details Popup -->
<div class="token-popup" id="token-popup">
<div class="token-popup-content">
<h3 id="token-title"></h3>
<div class="tokenomics-circle" id="tokenomics-circle"></div>
<p id="token-details"></p>
<button class="close-btn" onclick="closeTokenPopup()">Close</button>
</div>
</div>

<!-- QR Scanner Popup -->
<div class="scanner-popup" id="scanner-popup">
<div class="scanner-popup-content">
<video id="video" width="300" height="300" style="border:1px solid #ccc;"></video>
<p id="scanner-msg"></p>
<button class="close-btn" onclick="closeScanner()">Close</button>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.js"></script>
<script>
let tokens=[
  {emoji:'ü™ô',name:'GoldCoin'},
  {emoji:'üíé',name:'Diamond'},
  {emoji:'üöÄ',name:'Rocket'},
  {emoji:'üê∂',name:'Doge'},
  {emoji:'üçå',name:'Banana'},
  {emoji:'üî•',name:'Fire'},
  {emoji:'üåï',name:'Moon'},
  {emoji:'üê±',name:'CatToken'},
  {emoji:'üéÆ',name:'Gamer'},
  {emoji:'üèÜ',name:'Trophy'},
  {emoji:'‚ö°',name:'Thunder'},
  {emoji:'üçï',name:'Pizza'},
  {emoji:'üêâ',name:'Dragon'},
  {emoji:'üßä',name:'Ice'},
  {emoji:'üéµ',name:'Music'}
];

function randomPrice(){return (Math.random()*(5-0.01)+0.01).toFixed(2);}
function generateWalletAddress(){const chars='abcdefghijklmnopqrstuvwxyz0123456789';let addr='kingdom';for(let i=0;i<32;i++){addr+=chars.charAt(Math.floor(Math.random()*chars.length));}return addr;}
function initWallet(){
let addr=localStorage.getItem('walletAddress');let bal=localStorage.getItem('balance')||'0';
if(!addr){addr=generateWalletAddress();localStorage.setItem('walletAddress',addr);localStorage.setItem('balance','0');}
document.getElementById('balance').textContent=`${parseFloat(bal).toFixed(2)} KDM`;
document.getElementById('wallet-address').textContent=addr;
const tokensGrid=document.getElementById('tokens-grid');tokensGrid.innerHTML="";
tokens.forEach(token=>{
  token.price=randomPrice();
  const div=document.createElement('div');
  div.className='token';
  div.onclick=()=>showTokenDetails(token);
  div.innerHTML=`<span class="token-price">$${token.price}</span><span class="token-name">${token.emoji} ${token.name}</span>`;
  tokensGrid.appendChild(div);
});
setInterval(updatePrices,5000);
}
function updatePrices(){document.querySelectorAll('.token').forEach((div,i)=>{let newPrice=randomPrice();tokens[i].price=newPrice;div.querySelector('.token-price').textContent=`$${newPrice}`;});}

function deposit(){let bal=parseFloat(localStorage.getItem('balance')||'0');const amt=prompt('Enter deposit amount (KDM):');if(amt&&!isNaN(amt)&&amt>0){bal+=parseFloat(amt);localStorage.setItem('balance',bal.toFixed(2));document.getElementById('balance').textContent=`${bal.toFixed(2)} KDM`;alert('Deposit successful!');}else{alert('Invalid amount!');}}

function openSendPopup(){document.getElementById('send-popup').style.display='flex';}
function closeSendPopup(){document.getElementById('send-popup').style.display='none';}
function send(){let bal=parseFloat(localStorage.getItem('balance')||'0');const addr=document.getElementById('send-address').value.trim();const amt=parseFloat(document.getElementById('send-amount').value);if(!addr||amt<=0||isNaN(amt)){alert('Enter valid address and amount!');return;}if(amt<=bal){bal-=amt;localStorage.setItem('balance',bal.toFixed(2));document.getElementById('balance').textContent=`${bal.toFixed(2)} KDM`;alert(`Sent ${amt} KDM to ${addr}`);closeSendPopup();}else{alert('Insufficient balance!');}}

function receive(){const popup=document.getElementById('receive-popup');const addr=localStorage.getItem('walletAddress');document.getElementById('wallet-address').textContent=addr;QRCode.toCanvas(document.getElementById('qr-code'),addr,function(err){if(err)console.error(err);});popup.style.display='flex';}
function copyAddress(){const addr=localStorage.getItem('walletAddress');navigator.clipboard.writeText(addr);alert('Address copied!');}
function closePopup(){document.getElementById('receive-popup').style.display='none';}

function showTokenDetails(token){
  document.getElementById('token-title').textContent=`${token.emoji} ${token.name}`;
  // Generate random tokenomics
  const total=1000000;const comm=Math.floor(Math.random()*total);const invest=Math.floor(Math.random()*(total-comm));const liquidity=Math.floor(Math.random()*(total-comm-invest));const others=total-comm-invest-liquidity;
  const circle=document.getElementById('tokenomics-circle');circle.innerHTML='';
  const segments=[{color:'red',val:comm},{color:'blue',val:invest},{color:'green',val:liquidity},{color:'orange',val:others}];
  let start=0;
  segments.forEach(seg=>{
    const angle=(seg.val/total)*360;
    const segDiv=document.createElement('div');segDiv.className='segment';
    segDiv.style.transform=`rotate(${start}deg)`;const inner=document.createElement('div');inner.className='segment-inner';inner.style.background=seg.color;inner.style.transform=`rotate(${angle}deg)`;segDiv.appendChild(inner);circle.appendChild(segDiv);start+=angle;
  });
  const details=`Price: $${token.price}<br>Total Supply: ${total}<br>Circulating: ${total-Math.floor(Math.random()*50000)}<br>Holders: ${Math.floor(Math.random()*10000)}<br>Listing: ${new Date(Date.now()-Math.random()*1e10).toLocaleDateString()}`;
  document.getElementById('token-details').innerHTML=details;
  document.getElementById('token-popup').style.display='flex';
}
function closeTokenPopup(){document.getElementById('token-popup').style.display='none';}

// Scanner
let videoStream;
function openScanner(){
  const popup=document.getElementById('scanner-popup');popup.style.display='flex';
  const video=document.getElementById('video');
  navigator.mediaDevices.getUserMedia({video:{facingMode:'environment'}})
    .then(stream=>{videoStream=stream;video.srcObject=stream;video.setAttribute('playsinline',true);video.play();requestAnimationFrame(tick);})
    .catch(()=>document.getElementById('scanner-msg').textContent='Camera access denied');
}
function closeScanner(){document.getElementById('scanner-popup').style.display='none';if(videoStream){videoStream.getTracks().forEach(track=>track.stop());}}
function tick(){const video=document.getElementById('video');if(video.readyState===video.HAVE_ENOUGH_DATA){const canvas=document.createElement('canvas');canvas.width=video.videoWidth;canvas.height=video.videoHeight;const ctx=canvas.getContext('2d');ctx.drawImage(video,0,0,canvas.width,canvas.height);const imageData=ctx.getImageData(0,0,canvas.width,canvas.height);const code=jsQR(imageData.data,canvas.width,canvas.height);if(code){processScan(code.data);return;}}requestAnimationFrame(tick);}
function processScan(data){const myAddress=localStorage.getItem('walletAddress');if(data&&data.startsWith('kingdom')){let amount=prompt(`Send how much KDM to ${data}?`);if(amount&&!isNaN(amount)&&amount>0){let bal=parseFloat(localStorage.getItem('balance')||'0');if(bal>=amount){bal-=parseFloat(amount);localStorage.setItem('balance',bal.toFixed(2));document.getElementById('balance').textContent=`${bal.toFixed(2)} KDM`;alert(`Sent ${amount} KDM to ${data}`);}else{alert('Insufficient balance!');}}}closeScanner();}
window.onload=initWallet;
</script>
</body>
</html>
